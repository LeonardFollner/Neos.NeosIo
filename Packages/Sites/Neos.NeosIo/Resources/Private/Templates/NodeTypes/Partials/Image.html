{namespace neos=TYPO3\Neos\ViewHelpers}
{namespace media=TYPO3\Media\ViewHelpers}
<figure>
	<f:if condition="{image}">
		<f:then>
			<f:if condition="{link}">
				<f:then>
					<a href="{link}"><media:image asset="{image}" class="{imageClassName}" alt="{alternativeText}" title="{title}" maximumWidth="{maximumWidth}" maximumHeight="{maximumHeight}" /></a>
				</f:then>
				<f:else>
					<media:image asset="{image}" alt="{alternativeText}" class="{imageClassName}" title="{title}" maximumWidth="{maximumWidth}" maximumHeight="{maximumHeight}" />
				</f:else>
			</f:if>
		</f:then>
		<f:else>
			<f:if condition="{node.context.workspace.name} != 'live'">
				<img src="{f:uri.resource(package: 'TYPO3.Neos', path: 'Images/dummy-image.svg')}" title="Dummy image" alt="Dummy image" class="neos-handle" />
			</f:if>
		</f:else>
	</f:if>
	<f:if condition="{hasCaption}">
		<f:if condition="{node.context.workspace.name} != 'live'">
			<f:then>
				<f:if condition="{linkCaption}">
					<f:then>
						<f:if condition="{link}">
							<figcaption>
								<neos:contentElement.editable property="caption">{caption -> f:format.raw()}</neos:contentElement.editable>
							</figcaption>
						</f:if>
					</f:then>
					<f:else>
						<figcaption>
							<neos:contentElement.editable property="caption">{caption -> f:format.raw()}</neos:contentElement.editable>
						</figcaption>
					</f:else>
				</f:if>
			</f:then>
			<f:else>
				<figcaption>
					<f:if condition="{link}">
						<f:then>
							<a href="{link}"><neos:contentElement.editable property="caption">{caption -> f:format.raw()}</neos:contentElement.editable></a>
						</f:then>
						<f:else>
							<neos:contentElement.editable property="caption">{caption -> f:format.raw()}</neos:contentElement.editable>
						</f:else>
					</f:if>
				</figcaption>
			</f:else>
		</f:if>
	</f:if>
</figure>